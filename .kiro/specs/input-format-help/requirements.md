# 要件定義書

## プロジェクト説明（入力）
--input 引数で与えるファイルのフォーマット構造をヘルプで表示

## はじめに

Water Sort Puzzle Solver CLI は現在 `--input` 引数で YAML / JSON / テキスト形式のファイルを受け付けているが、各フォーマットの具体的な構造をユーザーが参照できる手段がない。本フィーチャーは、`--input-format-help` オプションを新設し、対応する全フォーマットのスキーマと記述例を標準出力に表示することで、ユーザーの入力ファイル作成を支援する。

---

## 要件

### 要件 1: フォーマットヘルプ表示オプションの追加

**目的:** CLIユーザーとして、`--input-format-help` オプションを実行することで、`--input` 引数に渡す入力ファイルの対応フォーマット一覧と各フォーマットの記述例を確認できるようにしたい。これにより、入力ファイルを正しく作成できる。

#### 受け入れ基準

1. When ユーザーが `--input-format-help` オプションを指定してツールを起動したとき, the CLI shall 対応する全フォーマット（YAML・JSON・テキスト）の構造説明とサンプルを標準出力に表示し、終了コード 0 で終了する。
2. When ユーザーが `--input-format-help` オプションを指定したとき, the CLI shall `--input` が未指定であっても解析・探索処理を実行せずにヘルプ内容のみを出力して終了する。
3. The CLI shall `--input-format-help` オプションを `--help` の説明文中に「入力ファイルのフォーマット仕様を表示する」として記載する。
4. When ユーザーが `--input-format-help` と他の実行系オプション（`--input`、`--strategy` 等）を同時に指定したとき, the CLI shall フォーマットヘルプのみを出力し、解析処理を実行しない。

---

### 要件 2: YAML フォーマット仕様の表示

**目的:** CLIユーザーとして、YAML 形式の入力ファイルのキー構造・型・記述例を確認できるようにしたい。これにより、YAML ファイルを誤りなく作成できる。

#### 受け入れ基準

1. When フォーマットヘルプが表示されるとき, the CLI shall YAML フォーマットのセクションに `bottles` キーがリスト型であることを明示する。
2. When フォーマットヘルプが表示されるとき, the CLI shall YAML フォーマットのセクションに空ボトルを表す `null` または空リスト `[]` の記法を示す。
3. When フォーマットヘルプが表示されるとき, the CLI shall YAML フォーマットのセクションに有効な最小構成サンプル（ボトル 4 本以上を含む）を表示する。
4. When フォーマットヘルプが表示されるとき, the CLI shall YAML フォーマットのセクションにファイル拡張子の対応（`.yaml` / `.yml`）を記載する。

---

### 要件 3: JSON フォーマット仕様の表示

**目的:** CLIユーザーとして、JSON 形式の入力ファイルのキー構造・型・記述例を確認できるようにしたい。これにより、JSON ファイルを誤りなく作成できる。

#### 受け入れ基準

1. When フォーマットヘルプが表示されるとき, the CLI shall JSON フォーマットのセクションに `{"bottles": [...]}` のトップレベル構造を明示する。
2. When フォーマットヘルプが表示されるとき, the CLI shall JSON フォーマットのセクションに空ボトルを表す空配列 `[]` の記法を示す。
3. When フォーマットヘルプが表示されるとき, the CLI shall JSON フォーマットのセクションに有効な最小構成サンプル（ボトル 4 本以上を含む）を表示する。
4. When フォーマットヘルプが表示されるとき, the CLI shall JSON フォーマットのセクションにファイル拡張子の対応（`.json`）を記載する。

---

### 要件 4: テキストフォーマット仕様の表示

**目的:** CLIユーザーとして、テキスト形式の入力ファイルの行フォーマット・空ボトルの表現・記述例を確認できるようにしたい。これにより、テキストファイルを誤りなく作成できる。

#### 受け入れ基準

1. When フォーマットヘルプが表示されるとき, the CLI shall テキストフォーマットのセクションに「1 行 = 1 ボトルの色をスペース区切りで列挙」というルールを記載する。
2. When フォーマットヘルプが表示されるとき, the CLI shall テキストフォーマットのセクションに空ボトルを表す `(empty)` キーワードを明示する。
3. When フォーマットヘルプが表示されるとき, the CLI shall テキストフォーマットのセクションに有効な最小構成サンプル（ボトル 4 本以上を含む）を表示する。
4. When フォーマットヘルプが表示されるとき, the CLI shall テキストフォーマットのセクションに空行が無視されることを記載する。

---

### 要件 5: 共通制約の表示

**目的:** CLIユーザーとして、全フォーマットに共通するパズル構成の制約（ボトル本数・容量統一ルール等）をヘルプ内で確認できるようにしたい。これにより、検証エラーを事前に防ぐことができる。

#### 受け入れ基準

1. When フォーマットヘルプが表示されるとき, the CLI shall 共通制約セクションにボトル本数の範囲（最小 4 本・最大 20 本）を明示する。
2. When フォーマットヘルプが表示されるとき, the CLI shall 共通制約セクションに「非空ボトルはすべて同一の容量（セグメント数）でなければならない」というルールを記載する。
3. When フォーマットヘルプが表示されるとき, the CLI shall 共通制約セクションに色名が任意の文字列であることを記載する。
4. When フォーマットヘルプが表示されるとき, the CLI shall フォーマット自動検出がファイル拡張子に基づくことを説明する（`.yaml`/`.yml` → YAML, `.json` → JSON, その他 → テキスト）。
